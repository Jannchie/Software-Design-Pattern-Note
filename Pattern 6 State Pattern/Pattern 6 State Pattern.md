## Pattern 6: State Pattern  状态模式

### Summary——概述

**状态模式**（State Pattern）属于行为型模式。类的行为随着状态的改变而改变。
在状态模式中，我们需要创建表示各种状态的对象和一个行为随着状态对象改变而改变的 context 对象。

---

### Example——状态模式的例子

有一些类的状态会发生改变，在不同的状态下，类的行为也会发生变化。比如图书馆的一本书，在没有人借走它的情况下，它拥有被借走的方法。而一旦被人借走，它就不再能被借出，同时拥有了被归还的方法。

将上述描述转化为UML类图：

<center>

![图5-1 传统策略](https://raw.githubusercontent.com/Jannchie/Software-Design-Pattern-Note/master/Pattern%205%20Strategy%20Pattern/5-1.png)

</center>

上述的模式明显非常简单不做作。算是只用了一个类，把所有的策略列举成不同的方法放在Sort类中。当然了，这样模式看一眼就知道问题极大，首先就不满足开闭原则，并且需要许多的判断语句来确保选择了正确的算法。

所以我们采用策略模式：

<center>

![图5-2 策略模式](https://raw.githubusercontent.com/Jannchie/Software-Design-Pattern-Note/master/Pattern%205%20Strategy%20Pattern/5-2.png)

</center>

策略模式通过一个接口，将每一个算法封装成为一个类。使用时，只需要调用子类的sort方法即可进行策略的选择。

---

### Why——为什么要使用策略模式

使用策略模式的优点是显而易见的：

- 完成同一类操作的算法可以自由切换
- 避免使用难以维护的多种条件判断
- 符合开闭原则，扩展性良好

---

### Disadvantage——策略模式的缺点

当然策略模式也不是完美的，它有着如下的缺点：

- 客户端必须知道策略模式的方法，即策略模式的方法要对外暴露。
- 策略类会增加类的数量，造成类的膨胀。

因此，如果一个系统的策略多于四个，就需要考虑使用混合模式，解决策略类膨胀的问题。

---

### 结语

策略模式是一种简单有效且实用的设计模式。它提供了一种从多种同样功能的方法中选择其一的操作，并且易于维护。策略模式让算法独立于使用它的客户而独立变化，从而可以取消自顶向下的依赖。